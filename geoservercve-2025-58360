Room: https://tryhackme.com/room/geoservercve202558360

Task 1 ]

XML - Extensible markup language
An External entity (XXE) vulnerability discovered in late 2025
CVSS - 9.8 , assesmed by NIST

Geoserver used by goverment and private organisation to publish and manage geospatial data.
Exploitation through XML payload.

Learning Obj
- Understand the role of Geoserver in modern geospital system
- How XXE vuln arise in XML parsers
- Exploit Vuln to retrive sensitve sys files
- Analyze web access logs & GeoServer apps logs to detect exploination activity

Task 2]

Geoserver is an opensource server that enable users to publish, share and edit geospatial data.

Who use GeoServer?
-Govenrment agencies
- Emergency service
- Researchers
- Private comapnies
- more

Access?
GeoServer is ofthen accessed throug web app and GIS tools.
Interact with cli.
Tools : curl ( used to test service, validate config changes, troubleshooting )

as HTTP GET request:
- GetCapabilities ( List layer & capabilities )
- GetMap ( Map Image )
- GetFeautureInfo ( Get attributes )
- DescribeLayer ( Layer feautures metadata )
- GetLegendGraphic ( Layer legend image )

Commands to get info from GeoS
curl -s "http://[IP]:[PORT]/geoserver/wms?service=WMS&version=1.1.1&request=DescribeLayer

send http, specifies the target ip and GeoS Web Map Service (WMS) endpoint, defines the service type,protocol vers, and operation being requested, specifies the layer for which metadata should be returned
    
Example GetMap operaiton]
curl -X POST "http://[IP]:[PORT]/geoserver/wms?REQUEST=GetMap&SERVICE=WMS" -H "Content-Type: application/xml" -d [xml document]

XML Document Contained:
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE ServiceExceptionReport SYSTEM "http://[IP]:[PORT]/geoserver/schemas/wms/1.1.1/WMS_exception_1_1_1.dtd">
<ServiceExceptionReport version="1.1.1">
  <ServiceException>
    Unknown layer: geoserverxxe # contents of /etc/hostname
  </ServiceException>
</ServiceExceptionReport>

Also you can use Metasploit Framework, just search it in msfconsole ' search geoserver '
U will see ' auxiliary/gather/geoserver_wms_getmap_xxe_file_read '
Use it , set RHOST, RPORT and exploit.

Task 4]

Why this exploit works?
= GeoServer vuln allows XML External Entity injection
GeoSe legitimately processes user-supploied XML as part of its nroaml operations.

Investigating Log Data with GeoServer built-in logging capabilities ( by default, it only shows WARN adn ERROR logs in log viewer )
Locate - About & Status > GeoServer Logs

SIEM with Elastic
- enabling us to centrally search and analyze both GeoS and Tomcat access logs.

Noted:
Web access logs record request metadata, not request bodies. Because the file targeted by attacker is defined within XML Doc itself.

Conclusion ]

Patching and Prevention 
- the most effective defense againts XXE is prevention through proper patching and hardening.
- GeoS kept up to date with the latest security release
- XML parsers should be configured to disable External Entity resolution if possible

Thank you.
